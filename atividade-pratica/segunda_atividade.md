-- Questão 8
SELECT 
    p.nome, pa.data_cadastro
FROM 
    pessoa p
JOIN
    paciente pa
ON 
    pa.pessoa_id = p.id; 

-- Questão 9

SELECT 
    p.nome, me.crm, e.nome AS especialidade
FROM 
    pessoa p
JOIN
    medico me
ON 
    me.pessoa_id = p.id
JOIN
    especialidade e
ON 
    me.especialidade_id = e.id;

-- Questão 10

CREATE TABLE endereco (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    logradouro varchar(255) NOT NULL,
    numero varchar(50) NOT NULL,
    complemento varchar(255),
    bairro varchar(100) NOT NULL,
    cidade varchar(100) NOT NULL,
    uf varchar(2) NOT NULL,
    cep varchar(20) NOT NULL
)

INSERT INTO endereco (logradouro, numero)
    SELECT 
        p.logradouro,
        p.numero
    FROM
        pessoa p;

ALTER TABLE 
    pessoa
ADD COLUMN
    endereco_id int; 

UPDATE
    pessoa p
SET
    endereco_id = e.id
FROM
    endereco e
WHERE
    p.id = e.id;